local class  = require "Class"
local base   = require "HudCore"
local this = class("NpcHud",base);

local data
local hud

function this:onEnter(c,d)
	self.hud =c;
	self.data = d
	data = d
	hud =c
	c:SetString("txt",d.name)
	-- self.txt.text=d.name;

	data:addListener(this,this.onDataChanged)

	local f = d.hp / d.maxHp
	self.hud:SetFloat("bar",f)

end

function this:onExit( ... )
	data:removeListener(this,this.onDataChanged)
end

function this:onDataChanged(_,property,oldV,newV)
	-- print(string.format("property:%s",property))
	if property == "name" then
		hud:SetString("txt",newV)
	elseif property == "hp" then
		-- print(string.format("o:%s,n:%s|maxHp %s",oldV,newV,data.maxHp))
		local f = newV / data.maxHp
		-- print(f)
		hud:SetFloat("bar",f)
	end
end

return this;