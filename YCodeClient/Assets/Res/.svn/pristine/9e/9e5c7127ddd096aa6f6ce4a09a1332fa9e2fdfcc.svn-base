require "UnsaveProxy"
local class = require "Class"
local base=require "UnsaveProxy"
local this = class("Proxy_Scene",base)
_G["Proxy_Scene"]=this

require "DefNamespace"
local sceneManager=_G["SceneEntityManager"]

function this:ctor()
	self._proxycenter=require"ProxyCenter"
end
function this:pushData(buffer,_)
	local data=self:_parseData(buffer)
	if not data then return end
	self._proxycenter._status=1
	self._proxycenter._sceneId=data.id
	sceneManager.AddListener(self,self.onSceneInited)
	sceneManager.ChangeScene(data)
end
function this:onSceneInited()
	self._proxycenter._status=0
	self._proxycenter:flush();
end
