local class=require "Class"
local this =class("Data_Character",require "Data")
local TypeClasses	= require "TypeClasses"
local db 			= require "TypeDB"

local instance = this.new()
local log = require"Logger"

local heroDb

local function ensureHero()
	if not heroDb then
		heroDb = db.getTable(TypeClasses.TYPE_HERO):selectOne({id=instance.heroId})
	end
end

local function split( str,reps )
    local resultStrList = {}
    if not str then return str end
    string.gsub(str,'[^'..reps..']+',function ( w )
        table.insert(resultStrList,w)
    end)
    return resultStrList
end

function this.ctor()
	log:check(not instance,"singleton error: Data_Character can create only once")
end


function this.getHeroSkills()
	ensureHero()
	local tb = split(heroDb.skills,",")
	return tb
end

return instance